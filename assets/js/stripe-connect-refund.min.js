!function a(i,d,u){function f(n,e){if(!d[n]){if(!i[n]){var t="function"==typeof require&&require;if(!e&&t)return t(n,!0);if(c)return c(n,!0);var r=new Error("Cannot find module '"+n+"'");throw r.code="MODULE_NOT_FOUND",r}var o=d[n]={exports:{}};i[n][0].call(o.exports,function(e){return f(i[n][1][e]||e)},o,o.exports,a,i,d,u)}return d[n].exports}for(var c="function"==typeof require&&require,e=0;e<u.length;e++)f(u[e]);return f}({1:[function(e,n,t){"use strict";function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var u,r,f,a,i;window.WCVendorsStripeConnectRefund=window.WCVendorsStripeConnectRefund||{},u=window,r=document,f=jQuery,a=window.WCVendorsStripeConnectRefund,i={},a.init=function(){a.cache(),a.bindEvents(),a.addValidator()},a.cache=function(){i.window=f(u),i.body=f(r.body),i.refundAmountButtonLabel=f(".wc-order-refund-amount")},a.bindEvents=function(){f(".refund_order_item_qty").on("change",a.qtyChangeHandler),f(".refund input").on("change",a.debounce(a.changeRefundTotal,100)),f(".do-api-refund").on("click",a.refundHandler),f(".button.cancel-request").on("click",a.cancelRequest)},a.debounce=function(t,r){var o;return function(){var e=this,n=arguments;clearTimeout(o),o=setTimeout(function(){t.apply(e,n)},r)}},a.getRefundForm=function(e){return e.closest("form.wcvendors-refund")},a.qtyChangeHandler=function(){var n=f(this).val(),t=f(this).attr("max"),e=f(this).closest("tr"),r=e.find("td.line_cost").attr("data-sort-value")/t;t<n&&(n=t),e.find("td.line_cost input.refund_line_total").val(a.formatPrice(n*r)),e.find("td.line_tax").each(function(){var e=f(this).attr("data-total");"undefined"!==o(e)&&!1!==e&&f(this).find(".refund_line_tax").val(a.formatPrice(e/t*n))})},a.formatPrice=function(e){return Number(Number(e).toFixed(wcv_frontend_general.digits_after_decimal)).toString().replace(".",wcv_frontend_general.decimal_separator)},a.addValidator=function(){u.Parsley.addValidator("maxAmount",{validateString:function(e,n){return Number(e.replace(wcv_frontend_general.decimal_separator,"."))<=Number(n)},messages:{en:WCVSCRefund.i18n_invalid_amount}})},a.changeRefundTotal=function(){var e=a.getRefundForm(f(this)),n=0,t=f(this).val(),r=new RegExp("[^0-9"+wcv_frontend_general.decimal_separator+"]","g");f(this).val(t.replace(r,"")),e.find(".refund input:not(.refund_order_item_qty)").each(function(){n+=Number(f(this).val().replace(wcv_frontend_general.decimal_separator,"."))}),e.find('input[name="refund_amount"]').val(a.formatPrice(n)),e.find(".js-refund-amount").html(a.formatPrice(n))},a.refundHandler=function(){var e=f(this).closest("form.wcvendors-refund");if(u.confirm(WCVSCRefund.i18n_do_refund)){var n=e.find("#refund_amount").val(),t=e.find("#refund_reason").val(),r=e.find("#refunded_amount").val(),o={},a={},i={};e.find(".refund input.refund_order_item_qty").each(function(e,n){f(n).closest("tr").data("order_item_id")&&n.value&&(o[f(n).closest("tr").data("order_item_id")]=n.value)}),e.find(".refund input.refund_line_total").each(function(e,n){f(n).closest("tr").data("order_item_id")&&(a[f(n).closest("tr").data("order_item_id")]=n.value)}),e.find(".refund input.refund_line_tax").each(function(e,n){if(f(n).closest("tr").data("order_item_id")){var t=f(n).data("tax_id");i[f(n).closest("tr").data("order_item_id")]||(i[f(n).closest("tr").data("order_item_id")]={}),i[f(n).closest("tr").data("order_item_id")][t]=n.value}});var d={action:"wcvendors_create_refund_request",order_id:e.attr("data-order-id"),refund_amount:n,refunded_amount:r,refund_reason:t,line_item_qtys:JSON.stringify(o,null,""),line_item_totals:JSON.stringify(a,null,""),line_item_tax_totals:JSON.stringify(i,null,""),api_refund:f(this).is(".do-api-refund"),restock_refunded_items:"true",security:WCVSCRefund.order_item_nonce};f.post(wcv_frontend_general.ajax_url,d,function(e){!0===e.success?u.location.href=WCVSCRefund.dashboard_request_url:u.alert(e.data.error)})}},a.cancelRequest=function(){if(u.confirm(WCVSCRefund.i18n_confirm_cancel_request)){var e={action:"wcvendors_cancel_refund_request",request_id:f(this).attr("data-request-id"),security:WCVSCRefund.cancel_request_nonce};f.post(wcv_frontend_general.ajax_url,e,function(e){!0===e.success?u.location.href=WCVSCRefund.dashboard_request_url:u.alert(e.data.error)})}},f(a.init)},{}]},{},[1]);